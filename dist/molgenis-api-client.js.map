{"version":3,"file":null,"sources":["../src/molgenis-api-client.js"],"sourcesContent":["import 'isomorphic-fetch'\nimport { merge } from 'lodash'\nimport FormData from 'form-data'\n\nconst defaultOptions = {\n  'headers': {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json',\n    'X-Requested-With': 'XMLHttpRequest'\n  },\n  'credentials': 'same-origin'\n}\n\nconst isJsonResponse = (response) => {\n  const contentType = response.headers.get('content-type')\n  if (!contentType) {\n    return false\n  }\n  // Ignore case, whitespace and double quotes around charset as per http spec (https://tools.ietf.org/html/rfc7231#section-3.1.1.5)\n  const normalizedContentType = contentType.toLowerCase().split(' ').join('').split('\"').join('')\n  return normalizedContentType === 'application/json' || normalizedContentType === 'application/json;charset=utf-8'\n}\n\n/**\n * Handle the JSON response from the server.\n *\n * When an error occurs a default ErrorResponse from the server is returned.\n * This ErrorResponse returns an array of errors and error-codes\n *\n * Example errorResponse\n * @example\n * {\"errors\":\n *   [\n *     {\n *       \"message\":\"Group name 'test' is not a available, please choose a different group name.\",\n *       \"code\":\"DS16\"\n *     }\n *   ]\n * }\n *\n * note: there could be more than one error\n *\n */\nconst handleResponse = (response) => {\n  if (isJsonResponse(response)) {\n    return response.json().then(json => response.ok ? json : Promise.reject(json))\n  } else {\n    return response.ok ? response : Promise.reject(response)\n  }\n}\n\nconst mergeOptions = (method, options) => {\n  return merge({method: method}, defaultOptions, options)\n}\n\n/**\n * Get a JSON object from the server\n * Uses your session ID to authenticate\n *\n * @example <caption>Example of how to use the get method</caption>\n * // Handle a promise from calling /api/v2/EntityType\n * get('/api/v2/EntityType').then(response => {...}, error => {...}))\n *\n * @example <caption>Example of how to use the get method with an added option</caption>\n * // Handle a promise from calling /api/v2/EntityType with different content type\n * get('/api/v2/EntityType', { headers: { 'Content-type': 'text' } }).then(response => {...}, error => {...})\n *\n * @param url The URL to post to e.g. /api/v2/my_data_set\n * @param options_ An object containing additional options like headers or body\n */\nconst get = (url, options_) => {\n  const options = mergeOptions('GET', options_)\n  return fetch(url, options).then(handleResponse).then(response => response)\n}\n\n/**\n * Post a body of data to the server\n * Uses your session ID to authenticate\n *\n * @example <caption>Example of how to use the post method</caption>\n * // Post a data object and handle the response\n * const data = {\n *  items: ['1', '2'],\n *  id: 'example'\n * }\n *\n * const options = {\n *  body: data\n * }\n *\n * post('api/v2/PostData', options).then(response => {...}, error => {...})\n *\n * @param url\n * @param options_\n */\nconst post = (url, options_) => {\n  const options = mergeOptions('POST', options_)\n  return fetch(url, options).then(handleResponse).then(response => response)\n}\n\n/**\n * Put a body of data to the server\n * Uses your session ID to authenticate\n *\n * @example <caption>Example of how to use the post method</caption>\n * // Put a data object and handle the response\n * const data = {\n *  items: ['1', '2'],\n *  id: 'example'\n * }\n *\n * const options = {\n *  body: data\n * }\n *\n * put('api/v2/PostData', options).then(response => {...}, error => {...})\n *\n * @param url\n * @param options_\n */\nconst put = (url, options_) => {\n  const options = mergeOptions('PUT', options_)\n  return fetch(url, options).then(handleResponse).then(response => response)\n}\n\n/**\n * Call a delete method on the server\n * Uses your session ID to authenticate\n *\n * @example <caption>Example of how to use the delete_ method</caption>\n * // Handle the response from calling DELETE on /api/v2/deleteById/1\n * delete_('/api/v2/deleteById/1').then(response => {...}, error => {...})\n *\n * @param url\n * @param options_\n */\nconst delete_ = (url, options_) => {\n  const options = mergeOptions('DELETE', options_)\n  return fetch(url, options).then(handleResponse).then(response => response)\n}\n\n/**\n * Post a file to the server\n * FormData is created with a 'file' parameter. A POST is then automatically created.\n * Uses your session ID to authenticate\n *\n * Expects the response from the server to contain a Job URL\n *\n * @example <caption>Example of how the use the postFile method</caption>\n * // Post a file and handle the response\n * postFile('/plugin/one-click-importer/upload', myAwesomeFile).then(response => {...}, error => {...})\n *\n * @param url\n * @param file\n */\nconst postFile = (url, file) => {\n  const form = new FormData()\n  form.append('file', file)\n\n  const options = {\n    body: form,\n    method: 'POST',\n    credentials: 'same-origin'\n  }\n\n  return fetch(url, options).then(handleResponse).then(response => response)\n}\n\nexport default {get, post, put, delete_, postFile}\n"],"names":["defaultOptions","isJsonResponse","response","contentType","headers","get","normalizedContentType","toLowerCase","split","join","handleResponse","json","then","ok","reject","mergeOptions","method","options","merge","url","options_","fetch","post","put","delete_","postFile","file","form","FormData","append"],"mappings":"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"}